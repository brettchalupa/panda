#!/bin/bash

# Stingray "ok" script - runs all Flutter checks
# Exit on first failure
set -e

# Color codes for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

print_step() {
    echo -e "${YELLOW}▶ $1${NC}"
}

print_success() {
    echo -e "${GREEN}✓ $1${NC}"
}

# 1. Format check (fast)
print_step "Checking format..."
dart format --output=none --set-exit-if-changed .
print_success "Format OK"

# 2. Analyze (fast, includes pub get check)
print_step "Analyzing..."
flutter analyze
print_success "Analysis OK"

# 3. Tests (moderate speed)
print_step "Testing..."
flutter test --reporter=compact
print_success "Tests OK"

echo -e "${GREEN}All checks passed!${NC}"
